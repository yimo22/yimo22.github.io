---
aliases: 
tags:
---
# 수평 스케일링
여러개의 서버를 수평으로 두고, 로드 밸런서를 통해 이를 분별하는 방법.
## 장점
- 더 많은 서버를 배치할 수록, 더많은 트래픽을 받을 수 있다.

## 단점
- 유지할 서버들이 늘어난다.


# 수직 스케일링
더 좋은 성능의 서버를 두어 스케일링을 넓히는 방법
## 단점
- 결국 한계에 부딪힌다
- 일정 한계치를 이상에서는 많은 비용을 초래한다.
- 여전히 SPOF 문제를 해결할 수 없다.
## 장점
- 유지할 대상이 적어져, 운영하기 쉬워진다.


# Stateless vs Stateful
웹서버는 Stateless 한 상태를 가져야 한다.

----
-> 시스템 설계를 기준으로, 서버의 위치는 중요하지 않다.
결국 문제가 발생하여 서버가 멈출 수 있는 가능성이 있기 때문이다.

----
DB관점에서의 스케일링
- Cold Standby
	- 다운시간이 증가하는 단점
	- 마지막 백업 이후 발생한 데이터는 손실된다.
	- 저렴하고 간단하다는 장점을 갖는다.
		- 잠깐 중지가 되거나 내부적인 용도 일 경우 ㅏ용한다.
- Warm Standby
	- 언제든지 사용할 수 있는 DB를 사용한다.
	  -> Replication을 통해 복제 DB를 매번 복제한다.
	- 백업데이터 베이스에 부하를 줄수 있다. 
	- 트래픽 양이 제한될 수 있다. 
- Hot standby
  Webserver 에서 여러개의 DB에 동시에 상태를 변경한다. 
	- 분산이 가능하다
	- 좀더 수평 스케일에 가깝다.
- 샤딩
	- 확장성 뿐만 아니라 복원력도 있다. 
	- 여러개의 샤드를 합쳐 데이터를 결합하는 것에 어렵다는 단점이 있다. 
	- Mongo DB (NOSQL-분산형DB)
		- 가용성을 위해 최소 3대의 서버를 권장
		- Config 서버또한 3개가 있음을 유의 (파티셔닝 스키마를 저장)
			- 하나가 다운되도 나머지 두대가 자동으로 새로운 서버를 생성
		-  이런 특징때문에, 주서버인 몽고디비가 다운되어도 빠르게 복구할 복원력을 갖게 되었다.
		- 하지만, 복원을 위해 모든 노드들을 3개의 Replicas 가 필요하기 때문에 많은 서버 비용이 들게 된다.
	- 카산드라
	  SPOF를 다른 방식으로 해결한다.
		- 링 시스템
			- 데이터를 다른 노드에 저장한다.
			- 어떤 노드든 기본접점(기본 인터페이스) 역할 (기본 API) 을 할 수 있다.
		- 모든 노드가 기본 노드가 될 수 있으므로, 최신 상태를 유지하려면 모든 노드에 데이터를 복제해야 한다. -> 모든 노드들은 어디에 있는지 항상 알고 있어야 한다.
		- 궁극적 일관성 을 조사해봐
		- 좀더 높은 가용성을 얻는 대신, 일관성은 포기하게 된다. (상충관계)
			- 데이터가 기록되면 다시 읽기까지 시간이 조금 걸린다.
			- 데이터를 쓰고 읽기까지 약간의 지연이 괜찮다면, 카산드라는 굳굳
	- 위의 모든 DB들은 샤드를 통해서 데이터를 다시 가져올수 있다. 
	  (API를 통해서 SQL로 질의를 하지만, 사실상 가능은 하다 다소 복잡할뿐...)
	- DB를 수평 스케일링 할때 리샤딩 하는데 문제가 있다.
	- 핫스팟 문제도 있다.
	  -> 특정 트래픽이 몰리는 데이터를 담고있는 DB에만 부하가 걸릴수 있다.
	  현대 아키텍처에서는 이런 문제를 Re-Sharding/hash을 통해서 해결함
	  
- 비정규화 (Denormalizing)
	- 업데이트가 어렵다.
	- 공간적인 낭비가 발생한다.
	- 한번의 hit로 데이터를 찾을 수 있다. (join할 필요가 없다.)
	  -> DB의 트래픽/성능병목 현상을 줄일 수 있다.


![[]]

